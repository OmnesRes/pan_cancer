dendrogram="col")
colors = c(seq(-3,-2,length=50),seq(-2,-1,length=50),seq(-1,1,length=100),seq(1,2,length=50),seq(2,3,length=50))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 299)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
seq(-3,-2,length=50)
seq(-2.5,-2,length=50)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
colors = c(seq(-2.5,-2,length=25),seq(-2,-1,length=50),seq(-1,1,length=100),seq(1,2,length=50),seq(2,2.5,length=25))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 249)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey2.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
colors = c(seq(-2.5,-1.5,length=50),seq(-1.5,-.5,length=50),seq(-.5,.5,length=50),seq(.5,1.5,length=50),seq(1.5,2.5,length=50))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 299)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 249)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey3.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
colors = c(seq(-2.5,-2,length=25),seq(-2,-1,length=50),seq(-1,1,length=100),seq(1,2,length=50),seq(2,2.5,length=25))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 249)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey3.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
tiff("gene_clustering_wkey3.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
colors = c(seq(-2.5,-2,length=25),seq(-2,-1.5,length=25),seq(-1.5,1.5,length=150),seq(1.5,2,length=25),seq(2,2.5,length=25))
tiff("gene_clustering_wkey3.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 122)
colors = c(seq(-2.5,-2,length=12),seq(-2,-1.5,length=12),seq(-1.5,1.5,length=75),seq(1.5,2,length=12),seq(2,2.5,length=12))
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey3.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
colors = c(seq(-3,-2.5,length=12),seq(-2.5,-2,length=12),seq(-2,2,length=100),seq(2,2.5,length=12),seq(2.5,3,length=12))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 147)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey3.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
#col=bluered(50),
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
#density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 150)
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 151)
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
library(gplots)
intensities <- read.delim("for_clustering.txt")
rmatrix1<-as.matrix(intensities[,-1])
row.names(rmatrix1) <- intensities[,1]
makeRowd <- function(intensities){
rowcor <- as.dist(1-cor(t(intensities)))
rowhc <- hclust(rowcor, method="average")
print(cor(cophenetic(rowhc), rowcor))
rowd <- as.dendrogram(rowhc)
return(list(rowd=rowd,rowhc=rowhc))
}
makeRowd(intensities)
colors = c(seq(-3,-2.5,length=14),seq(-2.5,-2,length=12),seq(-2,2,length=100),seq(2,2.5,length=12),seq(2.5,3,length=14))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 151)
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
colors = c(seq(-3,-2.5,length=25),seq(-2.5,-2,length=25),seq(-2,2,length=200),seq(2,2.5,length=25),seq(2.5,3,length=25))
my_palette <- colorRampPalette(c("blue", "#4D4DFF","white", "#FF4D4D","red"))(n = 299)
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
colors = c(seq(-2.75,-2.5,length=25),seq(-2.5,-2,length=25),seq(-2,2,length=200),seq(2,2.5,length=25),seq(2.5,2.75,length=25))
tiff("gene_clustering_wkey.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
tiff("gene_clustering.tiff",width=6,height=4,units="in",res=300)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
pdf("gene_clustering.pdf",, width=6,height=4)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
pdf("gene_clustering.pdf",, width=6,height=4)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
#key=FALSE,
density.info=c("none"),
keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
pdf("gene_clustering.pdf",, width=6,height=4)
heatmap.2(rmatrix1,
Rowv=makeRowd(rmatrix1)$rowd,
key=FALSE,
#density.info=c("none"),
#keysize=10,
Colv=makeRowd(t(rmatrix1))$rowd,
scale="row",
col=my_palette,
breaks=colors,
trace="none",
labRow=NA,
cexCol=1,
dendrogram="col")
dev.off()
